"use strict";require(["config"],function(){require(["jquery","template","cookie","header","footer"],function(v,e,n,t,a){v("#header").load("/html/component/header.html #headerTop",function(){t.nav(),t.cookie(),t.shopNum()}),v("#footer").load("/html/component/footer.html");var i=location.search.slice(1).split("="),o={};o[i[0]]=i[1],v.ajax({url:"http://localhost/EGu365/api/detail.php",data:o,method:"POST",dataType:"json",success:function(n){if(1==n.code){var t=e("detail-template",{product:n.product});v("#container").html(t)}v("#container").find("#proId").css({display:"none"}),function(){var e=v("#container #proDetail #numCount input"),n=v("#container #proId").html(),t=v.cookie("cart");if(null!=t)for(var a=JSON.parse(t),i=0;i<a.length;i++)a[i].id==n&&e.val(a[i].num);v("#container #num").on("click",".add-btn",function(n){var t=e.val();console.log("++前："+t),t++,console.log("++后："+t),e.val(t)}),v("#container #num").on("click",".sub-btn",function(n){var t=e.val();0==t?t=0:t--,e.val(t)})}();var a=v("#container").find("#bigImg"),i=v("#container").find("#magnify"),o=v("#container").find("#enlarged"),r=v("#container").find("#enlarged img");o.css({display:"none"}),a.mousemove(function(n){var t=n.clientX-a.offset().left-i.width()/2,e=n.clientY-(a.offset().top-v(window).scrollTop())-i.height()/2;t<0&&(t=0),e<0&&(e=0),t>a.width()-i.width()&&(t=a.width()-i.width()),e>a.height()-i.height()&&(e=a.height()-i.height()),i.css({display:"block"}),o.css({display:"block"}),i.css({left:t}),i.css({top:e}),r.css({left:-2*t}),r.css({top:-2*e})}),a.mouseleave(function(n){i.css({display:"none"}),o.css({display:"none"})})}}),v("#container").on("click","#addToCart",function(){var n=new Array,t=new Array,e=new Array,a=v(this).parent().parent().parent().find("#proId").html(),i=v(this).parent().parent().parent().find("#bigImg img").attr("src"),o=v(this).parent().parent().parent().find("#proname").html(),r=v(this).parent().parent().parent().find("#bazaarprice").html(),c=v(this).parent().parent().parent().find("#numCount input").val(),l=parseInt(a),s=parseInt(c),p=v.cookie("cart");if(null!=p)for(var d=JSON.parse(p),h=0;h<d.length;h++){var f={id:d[h].id,img:d[h].img,name:d[h].name,price:d[h].price,num:d[h].num};t.push(f)}for(var u=0;u<t.length;u++)if(t[u].id==l){t[u].num=s;break}if(u>=t.length){var m={id:a,img:i,name:o,price:r,num:c};e.push(m),t=t.concat(e)}n=n.concat(t);var g=JSON.stringify(n);v.cookie("cart",g,{path:"/",expires:1})})})});