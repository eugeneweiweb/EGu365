"use strict";require(["config"],function(){require(["jquery","template","cookie","header","footer"],function(g,n,e,t,i){g("#header").load("/html/component/header.html #headerTop",function(){t.nav(),t.cookie(),t.shopNum()}),g("#footer").load("/html/component/footer.html");var a=location.search.slice(1).split("="),o={};o[a[0]]=a[1],g.ajax({url:"http://localhost/EGu365/api/detail.php",data:o,method:"POST",dataType:"json",success:function(e){if(1==e.code){var t=n("detail-template",{product:e.product});g("#container").html(t)}g("#container").find("#proId").css({display:"none"});var i=g("#container").find("#bigImg"),a=g("#container").find("#magnify"),o=g("#container").find("#enlarged"),r=g("#container").find("#enlarged img");o.css({display:"none"}),i.mousemove(function(e){var t=e.clientX-i.offset().left-a.width()/2,n=e.clientY-(i.offset().top-g(window).scrollTop())-a.height()/2;console.log(i.offset().top),t<0&&(t=0),n<0&&(n=0),t>i.width()-a.width()&&(t=i.width()-a.width()),n>i.height()-a.height()&&(n=i.height()-a.height()),a.css({display:"block"}),o.css({display:"block"}),a.css({left:t}),a.css({top:n}),r.css({left:-2*t}),r.css({top:-2*n})}),i.mouseleave(function(e){a.css({display:"none"}),o.css({display:"none"})})}}),g("#container").on("click","#addToCart",function(){var e=new Array,t=new Array,n=new Array,i=g(this).parent().parent().parent().find("#proId").html(),a=g(this).parent().parent().parent().find("#bigImg img").attr("src"),o=g(this).parent().parent().parent().find("#proname").html(),r=g(this).parent().parent().parent().find("#bazaarprice").html(),c=g(this).parent().parent().parent().find("#numCount input").val(),s=parseInt(i),p=g.cookie("cart");if(null!=p)for(var l=JSON.parse(p),d=0;d<l.length;d++){var h={id:l[d].id,img:l[d].img,name:l[d].name,price:l[d].price,num:l[d].num};t.push(h)}for(var f=0;f<t.length;f++)if(t[f].id==s){t[f].num++;break}if(f>=t.length){var m={id:i,img:a,name:o,price:r,num:c};n.push(m),t=t.concat(n)}e=e.concat(t);var u=JSON.stringify(e);g.cookie("cart",u,{path:"/",expires:1})})})});